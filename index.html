<html>
  <head>
    <script>
      var resources = {
        clay: 0,
      };
      var generators = {
        clayGenerator: {
          amount: 0,
          cost: { },
          production: { clay: 1, },
        }
      };

      function log ( message ) {
        var console = document.getElementById("console");
        var row = console.insertRow(0);
        var cell = row.insertCell(0);
        cell.innerHTML = message;
        if (console.rows.length > 10)
          console.deleteRow(10);
      }

      function haveResources ( itemset ) {
        var have = true;
        Object.keys(itemset).forEach((key) => {
          if ( resources[key] < itemset[key] )
            have = false;
        });
        return have;
      }
      function getResources ( itemset, multiplier = 1 ) {
        Object.entries(itemset).forEach(([key, value]) => {
          resources[key] += value * multiplier;
        });
      }
      function spendResources ( itemset ) {
        Object.keys(itemset).forEach((key) => {
          resources[key] -= itemset[key];
        });
      }

      function runGenerators () {
        Object.entries(generators).forEach(([key, value]) => {
          getResources(value.production, value.amount);
        });
      }
      function buyGenerator ( generator ) {
        if ( ! haveResources(generators[generator].cost) ) {
          return;
        }
        spendResources(generators[generator].cost);
        generators[generator].amount++;
        document.getElementById("amount-" + generator).innerHTML = generators[generator].amount;
        log("Bought a " + generator);
      }

      function updateInventory () {
        Object.keys(resources).forEach((key) => {
          document.getElementById("amount-" + key).innerHTML = resources[key];
        });
        Object.keys(generators).forEach((key) => {
          document.getElementById("amount-" + key).innerHTML = generators[key].amount;
        });
      }

      setInterval(function() {
        runGenerators();
        updateInventory();
      }, 1000);

    </script>
  </head>
  <body style="color:#001780; font-family: Calibri; text-align:center">
    <h1 style="text-align:center">Singularity</h1>

    <div style="color:#000000">You have access to infinite amounts of mystery liquid.</div>
    <hr>
    <p>
      <div style="color:#000000">You have nothing else.</div>
    </p>

    <h3>Inventory</h3>
    <table style="margin-left:auto; margin-right:auto">
      <tr>
          <td>Clay <small id="amount-clay">0</small></td>
          <td>Clay Generator <small id="amount-clayGenerator">0</small></td>
          <td><button onclick="buyGenerator('clayGenerator')">Cost: Free</button></td>
      <tr>
    </table>

    <h4>Changelog</h4>
    <table id="changelog">
      <tr>
        <td>0.0.2303251744</td>
        <td>Reworked badic framework</td>
      </tr>
      <tr>
        <td>0.0.2303251704</td>
        <td>Hello again~</td>
      </tr>
    </table>

    <h4>Console</h4>
    <table id="console"></table>
  </body>
</html>
